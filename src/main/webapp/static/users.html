<!DOCTYPE html>
<html class="no-js" lang="zh-cn">

  <head>
    <meta charset="utf-8">
    <title>一流学科建设监控系统</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link rel="stylesheet" href="./css/bootstrap.min.css">
    <link rel="stylesheet" href="./css/plugins.css">
    <link rel="stylesheet" href="./css/main.css">
    <link rel="stylesheet" href="./css/themes.css">
    <script src="./js/vendor/modernizr-3.3.1.min.js"></script>
  </head>

  <body>
    <div id="page-wrapper" class="page-loading">
      <div class="preloader">
        <div class="inner">
          <div class="preloader-spinner themed-background hidden-lt-ie10"></div>
          <h3 class="text-primary visible-lt-ie10">
            <strong>Loading..</strong>
          </h3>
        </div>
      </div>

      <div id="page-container" class="header-fixed-top sidebar-visible-lg-full">
        <!-- Main Sidebar -->
        <div id="sidebar">
          <!-- Sidebar Brand -->
          <div id="sidebar-brand" class="themed-background">
            <a href="index.html" class="sidebar-title">
            <i class="fa fa-cube"></i>
            <span class="sidebar-nav-mini-hide">
              <strong>学科建设监控系统</strong>
            </span>
          </a>
          </div>
          <!-- END Sidebar Brand -->

          <!-- Wrapper for scrolling functionality -->
          <div id="sidebar-scroll">
            <!-- Sidebar Content -->
            <div class="sidebar-content">
              <!-- Sidebar Navigation -->
              <ul class="sidebar-nav">
                <li>
                  <a href="teachers.html">
                  <i class="gi gi-group sidebar-nav-icon"></i>
                  <span class="sidebar-nav-mini-hide">师资队伍建设</span>
                </a>
                </li>
                <li>
                  <a href="talent.html">
                  <i class="fa fa-graduation-cap sidebar-nav-icon"></i>
                  <span class="sidebar-nav-mini-hide">人才培养</span>
                </a>
                </li>
                <li>
                  <a href="science.html">
                  <i class="gi gi-lightbulb sidebar-nav-icon"></i>
                  <span class="sidebar-nav-mini-hide">科学研究与社会服务水平</span>
                </a>
                </li>
                <li>
                  <a href="subject.html">
                  <i class="fa fa-line-chart sidebar-nav-icon"></i>
                  <span class="sidebar-nav-mini-hide">学科影响力</span>
                </a>
                </li>
                <li>
                  <a href="international.html">
                  <i class="fa fa-globe sidebar-nav-icon"></i>
                  <span class="sidebar-nav-mini-hide">国际合作与交流</span>
                </a>
                </li>
                <li>
                  <a href="amaterial.html" id="ma">
                  <i class="hi hi-list-alt sidebar-nav-icon"></i>
                  <span class="sidebar-nav-mini-hide">材料审核</span>
                </a>
                </li>
                <li>
                  <a href="anotice.html" id="no">
                  <i class="fa fa-bell sidebar-nav-icon"></i>
                  <span class="sidebar-nav-mini-hide">公告通知</span>
                </a>
                </li>
                <li>
                  <a href="users.html" id="us" class="active">
                  <i class="fa fa-user sidebar-nav-icon"></i>
                  <span class="sidebar-nav-mini-hide">用户管理</span>
                </a>
                </li>
              </ul>
              <!-- END Sidebar Navigation -->
            </div>
            <!-- END Sidebar Content -->
          </div>
          <!-- END Wrapper for scrolling functionality -->

          <!-- Sidebar Extra Info -->
          <div id="sidebar-extra-info" class="sidebar-content sidebar-nav-mini-hide">
            <div class="text-center">
              <small>Copyright &copy;
                <a href="#" target="_blank">夜猫</a> 版权所有
              </small>
            </div>
          </div>
          <!-- END Sidebar Extra Info -->
        </div>
        <!-- END Main Sidebar -->

        <!-- Main Container -->
        <div id="main-container">
          <header class="navbar navbar-inverse navbar-fixed-top">
            <!-- Left Header Navigation -->
            <ul class="nav navbar-nav-custom">
              <!-- Main Sidebar Toggle Button -->
              <li>
                <a href="javascript:void(0)" onclick="App.sidebar('toggle-sidebar');this.blur();">
                  <i class="fa fa-ellipsis-v fa-fw animation-fadeInRight" id="sidebar-toggle-mini"></i>
                  <i class="fa fa-bars fa-fw animation-fadeInRight" id="sidebar-toggle-full"></i>
                </a>
              </li>
              <!-- END Main Sidebar Toggle Button -->

              <!-- Header Link -->
              <li class="hidden-xs animation-fadeInQuick">
                <a href="">
                  <strong>WELCOME</strong>
                </a>
              </li>
              <!-- END Header Link -->
            </ul>
            <!-- END Left Header Navigation -->

            <!-- Right Header Navigation -->
            <ul class="nav navbar-nav-custom pull-right">
              <li class="hidden-xs animation-fadeInQuick">
                <a href="">
                      <strong id="realname"></strong>
                    </a>
              </li>
              <!-- User Dropdown -->
              <li class="dropdown">
                <a href="javascript:void(0)" class="dropdown-toggle" data-toggle="dropdown">
                  <img src="./img/placeholders/avatars/user.jpg" alt="avatar">
                </a>
                <ul class="dropdown-menu dropdown-menu-right">
                  <li>
                    <a href="#modal-pwd" data-toggle="modal">
                      <i class="fa fa-pencil-square fa-fw pull-right"></i>
                      修改密码
                    </a>
                  </li>
                  <li>
                    <a href="login.html">
                      <i class="fa fa-power-off fa-fw pull-right"></i>
                      注销
                    </a>
                  </li>
                </ul>
              </li>
              <!-- END User Dropdown -->
            </ul>
            <!-- END Right Header Navigation -->
          </header>
          <!-- END Header -->
          <!-- 密码修改Modal -->
          <div id="modal-pwd" class="modal fade" tabindex="-1" role="dialog" aria-hidden="true">
            <div class="modal-dialog ">
              <div class="modal-content">
                <div class="modal-header">
                  <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                  <h3 class="modal-title">
                    <strong>密码修改</strong>
                  </h3>
                </div>
                <div class="modal-body">
                  <form method="post" class="form-horizontal form-bordered">
                    <div class="form-group">
                      <label class="col-md-3 control-label" for="pwd">旧密码</label>
                      <div class="col-md-4">
                        <input type="password" id="pwd" name="pwd" class="form-control" required="required" />
                    </div>
                      </div>
                      <div class="form-group">
                        <label class="col-md-3 control-label" for="newpwd">新密码</label>
                        <div class="col-md-4">
                          <input type="password" id="newpwd" name="newpwd" class="form-control" required="required" />
                    </div>
                        </div>
                        <div class="form-group">
                          <label class="col-md-3 control-label" for="repwd">确认密码</label>
                          <div class="col-md-4">
                            <input type="password" id="repwd" name="repwd" class="form-control" required="required" />
                    </div>
                          </div>
                  </form>
                </div>
                <div class="modal-footer">
                  <button type="button" class="btn btn-effect-ripple btn-primary" id="modifypwd" data-dismiss="modal">确定</button>
                  <button type="button" class="btn btn-effect-ripple btn-danger" data-dismiss="modal">取消</button>
                </div>
              </div>
            </div>
          </div>
          <!-- END 密码修改 Modal -->
          <!-- Page content -->
          <div id="page-content">
            <!-- Blank Header -->
            <div class="content-header">
              <div class="row">
                <div class="col-xs-6">
                  <div class="header-section">
                    <h1>用户管理</h1>
                  </div>
                </div>
                <a href="#modal-add" class="btn btn-effect-ripple btn-primary btn-title" data-toggle="modal">新增用户</a>
                <!-- 新增用户 Modal -->
                <div id="modal-add" class="modal fade" tabindex="-1" role="dialog" aria-hidden="true">
                  <div class="modal-dialog ">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                        <h3 class="modal-title">
                          <strong>新增用户</strong>
                        </h3>
                      </div>
                      <div class="modal-body">
                        <form method="post" class="form-horizontal form-bordered">

                          <div class="form-group">
                            <label class="col-md-3 control-label" for="username">工号</label>
                            <div class="col-md-4">
                              <input type="number" id="username" name="username" class="form-control" required="required" />
                          </div>
                            </div>
                            <div class="form-group">
                              <label class="col-md-3 control-label" for="name">用户名</label>
                              <div class="col-md-4">
                                <input type="text" id="name" name="name" class="form-control" required="required" />
                          </div>
                              </div>
                        </form>
                      </div>
                      <div class="modal-footer">
                        <button type="button" class="btn btn-effect-ripple btn-primary" id="useradd" data-dismiss="modal">确定</button>
                        <button type="button" class="btn btn-effect-ripple btn-danger" data-dismiss="modal">取消</button>
                      </div>
                    </div>
                  </div>
                </div>
                <!-- END 新增用户 Modal -->
              </div>
            </div>
            <!-- END Blank Header -->

            <!-- Get Started Block -->

            <div class="block full">
              <div class="block-title">
                <h2>用户管理</h2>
                <!-- <div class="btn-table">
                  <button type="button" class="btn btn-effect-ripple btn-primary" name="number" id="edit">编辑</button>
                  <button type="submit" class="btn btn-effect-ripple btn-primary" name="goal" id="save">保存</button>
                  <button type="button" class="btn btn-effect-ripple btn-danger" name="goal" id="cancel">取消</button>
                </div> -->
              </div>
              <div class="table-responsive">
                <table id="table" class="table table-striped table-bordered table-vcenter">
                  <thead>
                    <tr>
                      <th class="text-center" style="width: 125px;">序号</th>
                      <!-- <th class="hidden">id</th> -->
                      <th class="text-center">工号</th>
                      <th class="text-center">用户名</th>
                      <th class="text-center">操作</th>
                    </tr>
                  </thead>
                  <tbody id="user">

                  </tbody>
                </table>
              </div>
            </div>
            <!-- END Datatables Block -->
            <!-- END Get Started Content -->
          </div>
          <!-- END Page Content -->
        </div>
        <!-- END Main Container -->
      </div>
      <!-- END Page Container -->
    </div>
    <!-- END Page Wrapper -->
    <!-- 用户修改Modal -->
    <div id="modal-modify" class="modal fade" tabindex="-1" role="dialog" aria-hidden="true">
      <div class="modal-dialog ">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
            <h3 class="modal-title">
              <strong>用户修改</strong>
            </h3>
          </div>
          <div class="modal-body">
            <form method="post" id="modform" class="form-horizontal form-bordered">
              <!-- <input type="hidden" id="userid">
            <div class="form-group">
              <label class="col-md-3 control-label" for="username">工号</label>
              <div class="col-md-4">
                <input type="number" id="musername" name="username" class="form-control" required="required" />
              </div>
            </div>
            <div class="form-group">
              <label class="col-md-3 control-label" for="name">用户名</label>
              <div class="col-md-4">
                <input type="text" id="mname" name="name" class="form-control" required="required" />
              </div>
            </div> -->
            </form>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-effect-ripple btn-primary" id="usermodify" data-dismiss="modal">确定</button>
            <button type="button" class="btn btn-effect-ripple btn-danger" data-dismiss="modal">取消</button>
          </div>
        </div>
      </div>
    </div>
    <!-- END 用户修改 Modal -->

    <!-- 密码修改Modal -->
    <div id="modal-pwd" class="modal fade" tabindex="-1" role="dialog" aria-hidden="true">
      <div class="modal-dialog ">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
            <h3 class="modal-title">
              <strong>密码修改</strong>
            </h3>
          </div>
          <div class="modal-body">
            <form method="post" class="form-horizontal form-bordered">

              <div class="form-group">
                <label class="col-md-3 control-label" for="pwd">旧密码</label>
                <div class="col-md-4">
                  <input type="password" id="pwd" name="pwd" class="form-control" required="required" />
              </div>
                </div>
                <div class="form-group">
                  <label class="col-md-3 control-label" for="newpwd">新密码</label>
                  <div class="col-md-4">
                    <input type="password" id="newpwd" name="newpwd" class="form-control" required="required" />
              </div>
                  </div>
                  <div class="form-group">
                    <label class="col-md-3 control-label" for="repwd">确认密码</label>
                    <div class="col-md-4">
                      <input type="password" id="repwd" name="repwd" class="form-control" required="required" />
              </div>
                    </div>
            </form>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-effect-ripple btn-primary" id="modifypwd">确定</button>
            <button type="button" class="btn btn-effect-ripple btn-danger" data-dismiss="modal">取消</button>
          </div>
        </div>
      </div>
    </div>
    <!-- END 密码修改 Modal -->
    <!-- 确认操作 modal-->
    <div id="modal-delete" class="modal fade" tabindex="-1" role="dialog" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
            <h3 class="modal-title">
              <strong>确认操作</strong>
            </h3>
          </div>
          <div class="modal-body">
            <div class="form-group">
              <div class="col-xs-6">
                <span>是否确认删除？</span>
              </div>
            </div>
          </div>
          <div class="modal-footer" id="del_modal">

          </div>
        </div>
      </div>
    </div>
    <div id="modal-reset" class="modal fade" tabindex="-1" role="dialog" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
            <h3 class="modal-title">
              <strong>确认操作</strong>
            </h3>
          </div>
          <div class="modal-body">
            <div class="form-group">
              <div class="col-xs-6">
                <span>确定重置密码？</span>
              </div>
            </div>
          </div>
          <div class="modal-footer" id="mdf_modal">

          </div>
        </div>
      </div>
    </div>
    <!-- END 确认操作 Modal -->

    <!-- jQuery, Bootstrap, jQuery plugins and Custom JS code -->
    <script src="./js/vendor/jquery-2.2.4.min.js"></script>
    <script src="./js/vendor/bootstrap.min.js"></script>
    <script src="./js/plugins.js"></script>
    <script src="./js/app.js"></script>
    <script src="./js/main.js"></script>
    <script>
      $("#modifypwd").on("click", function () {
        a = $("#newpwd").val();
        b = $("#repwd").val();
        if (a != b) {
          alert("密码不一致");
        } else {
          return ture;
        }
      })
    </script>
    <script>
      userTable();
      // 新增用户
      $("#useradd").on("click", function () {
        var username = $("#username").val();
        var name = $("#name").val();
        $.ajax({
          url: ip + '/scm/users/add',
          type: 'POST',
          // headers: {
          //   'Content-Type': 'application/json'
          // },
          cache: false,
          // dataType:JSON,
          data: {
            username: username,
            name: name
          },
          success: function (data) {
            console.log(data)
            if (data == 1) {
              alert("添加成功");
            } else if (data == 0) {
              alert("添加失败")
            }
            $("#user").html("");
            userTable();
          },
          error: function (data) {
            console.log(data)
          }
        });
      })
      // 用户修改
      function modify(id) {
        $.ajax({
          url: ip + '/scm/users/id/' + id,
          type: 'GET',
          cache: false,

          success: function (data) {
            console.log(data)
            $.each(data, function (i, item) {
              var form = `
            <input type="hidden" id="id" value="`+ data.id + `">
            <div class="form-group">
              <label class="col-md-3 control-label" for="username">工号</label>
              <div class="col-md-4">
                <input type="number" id="musername" name="username" value="`+ data.username + `" class="form-control" required="required" />
              </div>
            </div>
            <div class="form-group">
              <label class="col-md-3 control-label" for="name">用户名</label>
              <div class="col-md-4">
                <input type="text" id="mname" name="name" value="`+ data.name + `" class="form-control" required="required" />
              </div>
            </div>
            `
              $("#modform").html("");
              $("#modform").append(form);
            })
          },
          error: function (data) {
            console.log(data)
          }

        });
      }

      $("#usermodify").on("click", function () {
        var id = $("#id").val();
        var username = $("#musername").val();
        var name = $("#mname").val();
        $.ajax({
          url: ip + '/scm/users/modify',
          type: 'POST',
          // headers: {
          //   'Content-Type': 'application/json'
          // },
          cache: false,
          // dataType:JSON,
          data: {
            id: id,
            username: username,
            name: name
          },
          success: function (data) {
            console.log(data)
            if (data == 1) {
              alert("修改成功");
            } else if (data == 0) {
              alert("修改失败")
            }
            $("#user").html("");
            userTable();
          },
          error: function (data) {
            console.log(data)
          }
        });
      })
      // 密码重置
      function reset(id) {
        $.ajax({
          url: ip + '/scm/users/reset/' + id,
          type: 'POST',
          cache: false,
          // data: {
          //   id: id,
          // },
          success: function (data) {
            console.log(data)
            if (data == 1) {
              alert("重置成功");
            } else if (data == 0) {
              alert("重置失败")
            }
          },
          error: function (data) {
            console.log(data)
          }
        });
      }
      // 用户删除
      function del(id) {
        // alert(id)
        $.ajax({
          url: ip + '/scm/users/delete/' + id,
          type: 'DELETE',
          cache: false,
          // data: {
          //   id: id
          // },
          success: function (data) {
            console.log(data)
            if (data == 1) {
              alert("删除成功");
            } else if (data == 0) {
              alert("删除失败")
            }
            $("#user").html("");
            userTable();
          },
          error: function (data) {
            console.log(data)
          }

        });
      }
    </script>

  </body>

</html>