<!DOCTYPE html>
<html class="no-js" lang="zh-cn">

  <head>
    <meta charset="utf-8">
    <title>一流学科建设监控系统</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link rel="stylesheet" href="./css/bootstrap.min.css">
    <link rel="stylesheet" href="./css/plugins.css">
    <link rel="stylesheet" href="./css/main.css">
    <link rel="stylesheet" href="./css/themes.css">
    <script src="./js/vendor/modernizr-3.3.1.min.js"></script>
  </head>

  <body>
    <div id="page-wrapper" class="page-loading">
      <div class="preloader">
        <div class="inner">
          <div class="preloader-spinner themed-background hidden-lt-ie10"></div>
          <h3 class="text-primary visible-lt-ie10">
            <strong>Loading..</strong>
          </h3>
        </div>
      </div>

      <div id="page-container" class="header-fixed-top sidebar-visible-lg-full">
        <!-- Main Sidebar -->
        <div id="sidebar">
          <!-- Sidebar Brand -->
          <div id="sidebar-brand" class="themed-background">
            <a href="index.html" class="sidebar-title">
            <i class="fa fa-cube"></i>
            <span class="sidebar-nav-mini-hide">
              <strong>学科建设监控系统</strong>
            </span>
          </a>
          </div>
          <!-- END Sidebar Brand -->

          <!-- Wrapper for scrolling functionality -->
          <div id="sidebar-scroll">
            <!-- Sidebar Content -->
            <div class="sidebar-content">
              <!-- Sidebar Navigation -->
              <ul class="sidebar-nav">
                <li>
                  <a href="./teachers.html">
                  <i class="gi gi-group sidebar-nav-icon"></i>
                  <span class="sidebar-nav-mini-hide">师资队伍建设</span>
                </a>
                </li>
                <li>
                  <a href="./talent.html">
                  <i class="fa fa-graduation-cap sidebar-nav-icon"></i>
                  <span class="sidebar-nav-mini-hide">人才培养</span>
                </a>
                </li>
                <li>
                  <a href="./science.html">
                  <i class="gi gi-lightbulb sidebar-nav-icon"></i>
                  <span class="sidebar-nav-mini-hide">科学研究与社会服务水平</span>
                </a>
                </li>
                <li>
                  <a href="./subject.html">
                  <i class="fa fa-line-chart sidebar-nav-icon"></i>
                  <span class="sidebar-nav-mini-hide">学科影响力</span>
                </a>
                </li>
                <li>
                  <a href="international.html">
                  <i class="fa fa-globe sidebar-nav-icon"></i>
                  <span class="sidebar-nav-mini-hide">国际合作与交流</span>
                </a>
                </li>
                <li>
                  <a href="amaterial.html" id="ma" class="active">
                  <i class="hi hi-list-alt sidebar-nav-icon"></i>
                  <span class="sidebar-nav-mini-hide">材料审核</span>
                </a>
                </li>
                <li>
                  <a href="anotice.html" id="no">
                  <i class="fa fa-bell sidebar-nav-icon"></i>
                  <span class="sidebar-nav-mini-hide">公告通知</span>
                </a>
                </li>
                <li>
                  <a href="users.html" id="us">
                  <i class="fa fa-user sidebar-nav-icon"></i>
                  <span class="sidebar-nav-mini-hide">用户管理</span>
                </a>
                </li>
              </ul>
              <!-- END Sidebar Navigation -->
            </div>
            <!-- END Sidebar Content -->
          </div>
          <!-- END Wrapper for scrolling functionality -->

          <!-- Sidebar Extra Info -->
          <div id="sidebar-extra-info" class="sidebar-content sidebar-nav-mini-hide">
            <div class="text-center">
              <small>Copyright &copy;
                <a href="#" target="_blank">夜猫</a> 版权所有
              </small>
            </div>
          </div>
          <!-- END Sidebar Extra Info -->
        </div>
        <!-- END Main Sidebar -->

        <!-- Main Container -->
        <div id="main-container">
          <header class="navbar navbar-inverse navbar-fixed-top">
            <!-- Left Header Navigation -->
            <ul class="nav navbar-nav-custom">
              <!-- Main Sidebar Toggle Button -->
              <li>
                <a href="javascript:void(0)" onclick="App.sidebar('toggle-sidebar');this.blur();">
                    <i class="fa fa-ellipsis-v fa-fw animation-fadeInRight" id="sidebar-toggle-mini"></i>
                    <i class="fa fa-bars fa-fw animation-fadeInRight" id="sidebar-toggle-full"></i>
                  </a>
              </li>
              <!-- END Main Sidebar Toggle Button -->

              <!-- Header Link -->
              <li class="hidden-xs animation-fadeInQuick">
                <a href="">
                    <strong>WELCOME</strong>
                  </a>
              </li>
              <!-- END Header Link -->
            </ul>
            <!-- END Left Header Navigation -->

            <!-- Right Header Navigation -->
            <ul class="nav navbar-nav-custom pull-right">
              <li class="hidden-xs animation-fadeInQuick">
                <a href="">
                        <strong id="realname"></strong>
                      </a>
              </li>
              <!-- User Dropdown -->
              <li class="dropdown">
                <a href="javascript:void(0)" class="dropdown-toggle" data-toggle="dropdown">
                    <img src="./img/placeholders/avatars/user.jpg" alt="avatar">
                  </a>
                <ul class="dropdown-menu dropdown-menu-right">
                  <li>
                    <a href="#modal-pwd" data-toggle="modal">
                        <i class="fa fa-pencil-square fa-fw pull-right"></i>
                        修改密码
                      </a>
                  </li>
                  <li>
                    <a href="login.html">
                        <i class="fa fa-power-off fa-fw pull-right"></i>
                        注销
                      </a>
                  </li>
                </ul>
              </li>
              <!-- END User Dropdown -->
            </ul>
            <!-- END Right Header Navigation -->
          </header>
          <!-- END Header -->

          <!-- Page content -->
          <div id="page-content">
            <!-- Blank Header -->
            <div class="content-header">
              <div class="row">
                <div class="col-xs-6">
                  <div class="header-section">
                    <h1>材料审核</h1>
                  </div>
                </div>
                <!-- 详情查看 Modal -->
                <div id="modal_check" class="modal fade" tabindex="-1" role="dialog" aria-hidden="true">
                  <div class="modal-dialog">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                        <h3 class="modal-title">
                          <strong>材料详情</strong>
                        </h3>
                      </div>
                      <div class="modal-body">
                        <form class="form-horizontal form-bordered" id="checkform">
                        </form>
                      </div>
                      <div class="modal-footer" id="footer">

                      </div>
                    </div>
                  </div>
                </div>
                <!-- END 详情查看 Modal -->
                <!-- 密码修改Modal -->
                <div id="modal-pwd" class="modal fade" tabindex="-1" role="dialog" aria-hidden="true">
                  <div class="modal-dialog ">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                        <h3 class="modal-title">
                          <strong>密码修改</strong>
                        </h3>
                      </div>
                      <div class="modal-body">
                        <form method="post" class="form-horizontal form-bordered">
                          <div class="form-group">
                            <label class="col-md-3 control-label" for="pwd">旧密码</label>
                            <div class="col-md-4">
                              <input type="password" id="pwd" name="pwd" class="form-control" required="required" />
                          </div>
                            </div>
                            <div class="form-group">
                              <label class="col-md-3 control-label" for="newpwd">新密码</label>
                              <div class="col-md-4">
                                <input type="password" id="newpwd" name="newpwd" class="form-control" required="required" />
                          </div>
                              </div>
                              <div class="form-group">
                                <label class="col-md-3 control-label" for="repwd">确认密码</label>
                                <div class="col-md-4">
                                  <input type="password" id="repwd" name="repwd" class="form-control" required="required" />
                          </div>
                                </div>
                        </form>
                      </div>
                      <div class="modal-footer">
                        <button type="button" class="btn btn-effect-ripple btn-primary" id="modifypwd" data-dismiss="modal">确定</button>
                        <button type="button" class="btn btn-effect-ripple btn-danger" data-dismiss="modal">取消</button>
                      </div>
                    </div>
                  </div>
                </div>
                <!-- END 密码修改 Modal -->
              </div>
            </div>
            <!-- END Blank Header -->

            <!-- Get Started Block -->

            <div class="block full">
              <div class="block-title">
                <h2>材料列表</h2>

              </div>
              <div class="table-responsive">
                <table id="example-datatable" class="table table-striped table-bordered table-vcenter">
                  <thead>
                    <tr>
                      <th class="text-center" style="width: 420px;">具体指标</th>
                      <th class="text-center" style="width: 100px;">提交人</th>
                      <th class="text-center">提交时间</th>
                      <th class="text-center" style="width: 95px;">审核状态</th>
                      <th class="text-center" style="width: 100px;">操作</th>
                    </tr>
                  </thead>
                  <tbody id="table">

                  </tbody>
                </table>
              </div>
            </div>
            <!-- END Datatables Block -->
            <!-- END Get Started Content -->
          </div>
          <!-- END Page Content -->
        </div>
        <!-- END Main Container -->
      </div>
      <!-- END Page Container -->
    </div>
    <!-- END Page Wrapper -->

    <!-- jQuery, Bootstrap, jQuery plugins and Custom JS code -->
    <script src="./js/vendor/jquery-2.2.4.min.js"></script>
    <script src="./js/vendor/bootstrap.min.js"></script>
    <script src="./js/plugins.js"></script>
    <script src="./js/app.js"></script>
    <script src="./js/main.js"></script>
  </body>
  <script>
    adminshow();
    // 查看记录详细信息
    function check(type, recordId) {
      $.ajax({
        url: ip + '/scm/material/specific/show/' + type + '/' + recordId,
        type: 'GET',
        cache: false,

        success: function (data) {
          console.log(data.status)
          var footer = `
            <button type="button" class="btn btn-effect-ripple btn-primary" data-dismiss="modal" onclick="handle(` + recordId + `,` + type + `,1)">接受</button>
                <button type="button" class="btn btn-effect-ripple btn-danger" data-dismiss="modal" onclick="handle(` + recordId + `,` + type + `,-1)">拒绝</button>
            `
          if (type == 0) {
            var form = `
              <div class="form-group form-inline">
                    <label class="col-md-3 control-label" for="">`+ data.pointModel.content + `</label>
                    <div class="col-md-4 material-admin offset-col-md-2">
                      <span>`+ data.value + `</span>
                    </div>
                  </div>
                  <div class="form-group">
                    <label class="col-md-3 control-label" for="">佐证材料:</label>
                    <div class="col-md-4">
                      <a href="http://localhost:8080/scm/material/download/` + type + '/' + data.id + `" class="btn btn-effect-ripple btn-primary">下载材料</a>
                    </div>
                  </div>
            `
            $("#checkform").html("");
            $("#checkform").append(form);
            if (data.status == 0) {
              $("#footer").html("");
              $("#footer").append(footer);
            }
          }
          else if (type == 1) {
            var form = `
              <div class="form-group">
                    <label class="col-md-3 control-label" for="">工号</label>
                    <div class="col-md-4 material-admin">
                      <span>` + data.username + `</span>
                    </div>
                  </div>
                  <div class="form-group">
                    <label class="col-md-3 control-label" for="">姓名</label>
                    <div class="col-md-4 material-admin">
                      <span>` + data.name + `</span>
                    </div>
                  </div>
                  <div class="form-group">
                    <label class="col-md-3 control-label" for="">出生日期</label>
                    <div class="col-md-4 material-admin">
                      <span>` + data.birthday + `</span>
                    </div>
                  </div>
                  <div class="form-group">
                    <label class="col-md-3 control-label" for="">学历</label>
                    <div class="col-md-4 material-admin">
                      <span>` + data.edu + `</span>
                    </div>
                  </div>
                  <div class="form-group">
                    <label class="col-md-3 control-label" for="">职称</label>
                    <div class="col-md-4 material-admin">
                      <span>` + data.title + `</span>
                    </div>
                  </div>
                  <div class="form-group">
                    <label class="col-md-3 control-label" for="">人才等级</label>
                    <div class="col-md-4 material-admin">
                      <span>` + data.rank + `</span>
                    </div>
                  </div>
                  <div class="form-group">
                    <label class="col-md-3 control-label" for="">是否在重要学术机构担任重要职务</label>
                    <div class="col-md-4 material-admin">
                      <span>` + data.isImportant + `</span>
                    </div>
                  </div>
                  <div class="form-group">
                    <label class="col-md-3 control-label" for="">佐证材料:</label>
                    <div class="col-md-4">
                      <a href="http://localhost:8080/scm/material/download/` + type + '/' + data.id + `" class="btn btn-effect-ripple btn-primary">下载材料</a>
                    </div>
                  </div>
              `
            $("#checkform").html("");
            $("#checkform").append(form);
            if (data.status == 0) {
              $("#footer").html("");
              $("#footer").append(footer);
            }
          }
          else if (type == 2) {
            var form = `
              <div class="form-group">
                    <label class="col-md-3 control-label" for="">类型</label>
                    <div class="col-md-4 material-admin">
                      <span>` + data.type + `</span>
                    </div>
                  </div>
                  <div class="form-group">
                    <label class="col-md-3 control-label" for="">名称</label>
                    <div class="col-md-4 material-admin">
                      <span>` + data.name + `</span>
                    </div>
                  </div>
                  <div class="form-group">
                    <label class="col-md-3 control-label" for="">负责人</label>
                    <div class="col-md-4 material-admin">
                      <span>` + data.leader + `</span>
                    </div>
                  </div>
                  <div class="form-group">
                    <label class="col-md-3 control-label" for="">等级</label>
                    <div class="col-md-4 material-admin">
                      <span>` + data.rank + `</span>
                    </div>
                  </div>
                  <div class="form-group">
                    <label class="col-md-3 control-label" for="">是否重点、重大项目或一等奖</label>
                    <div class="col-md-4 material-admin">
                      <span>` + data.isImportant + `</span>
                    </div>
                  </div>
                  <div class="form-group">
                    <label class="col-md-3 control-label" for="">佐证材料:</label>
                    <div class="col-md-4">
                      <a href="http://localhost:8080/scm/material/download/` + type + '/' + data.id + `" class="btn btn-effect-ripple btn-primary">下载材料</a>
                    </div>
                  </div>
              `
            $("#checkform").html("");
            $("#checkform").append(form);
            if (data.status == 0) {
              $("#footer").html("");
              $("#footer").append(footer);
            }
          }
          else if (type == 3) {
            var form = `
              <div class="form-group">
                    <label class="col-md-3 control-label" for="">论文名</label>
                    <div class="col-md-4 material-admin">
                      <span>` + data.title + `</span>
                    </div>
                  </div>
                  <div class="form-group">
                    <label class="col-md-3 control-label" for="">作者</label>
                    <div class="col-md-4 material-admin">
                      <span>` + data.member + `</span>
                    </div>
                  </div>
                  <div class="form-group">
                    <label class="col-md-3 control-label" for="">第一作者类型</label>
                    <div class="col-md-4 material-admin">
                      <span>` + data.firstType + `</span>
                    </div>
                  </div>
                  <div class="form-group">
                    <label class="col-md-3 control-label" for="">论文类型</label>
                    <div class="col-md-4 material-admin">
                      <span>` + data.paperType + `</span>
                    </div>
                  </div>
                  <div class="form-group">
                    <label class="col-md-3 control-label" for="">佐证材料:</label>
                    <div class="col-md-4">
                      <a href="http://localhost:8080/scm/material/download/` + type + '/' + data.id + `" class="btn btn-effect-ripple btn-primary">下载材料</a>
                    </div>
                  </div>
              `
            $("#checkform").html("");
            $("#checkform").append(form);
            if (data.status == 0) {
              $("#footer").html("");
              $("#footer").append(footer);
            }
          }
        },
        error: function (data) {
          console.log(data)
        }
      });
    }
    // 处理请求
    function handle(recordId, type, status) {
      $.ajax({
        url: ip + '/scm/material/admin/check?recordId=' + recordId + '&type=' + type + '&status=' + status,
        type: 'GET',
        cache: false,
        success: function (data) {
          console.log(data)
          if (data == 1) {
            alert("操作成功");
          } else if (data == 0) {
            alert("操作失败")
          }
          $("#table").html("");
          adminshow();
        },
        error: function (data) {
          console.log(data)
        }
      });
    }
  </script>

</html>